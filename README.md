# The notify service

Сервис с помощюкоторого можно делать рассылки на указанные Email.
Список email'ов нужно указать в ```application.yml``` в параметре
```email:destination``` чере сипвол ```|```. Можно было конечно хранить список email'ов
в БД и это, наверное, было бы правильнее текущего решения, но поскольку задача
тестовая, то я не стал прикручивать БД а ограничился значением в 
проперти.

## Как все запускать

Нужно найти на просторах Телеграмм бота с именем ```EmailSubscriber007Bot```
и запустить его. Наименование бота и токен бота, так-же прописывается в ```application.yml```.
Этот бот поддерживает только две команды ```/register``` и ```/deregister``` с указанием тужного
email для подписки о получении уведомлений с сервиса и так-же чтоб описатся от уведомлений в телеграмм.
Пример: /register mail@mail.ru - зарегестрироватся на сообщения которые сервис будет отсылать на email mail@mail.ru b
/deregister mail@mail.ru - т.е. отказатся от рассылки.


Далее про сам сервис. Первоначально, нужно посмотреть на ```application.yml```
Я наткнулся на вещь, что api.telegram.com было не доступно по причине блокировки Роскомнадзором и пришлось
прикручивать возможность обхода чере socks5 proxy. Если у вас из офиса API телеграм доступно, то делать ничего не нужно специально.
А если нужно работать через прокси, то в ```application.yml``` есть целая секция про прокси и думаю что вопросов не вызовет как настроить.
Так-же, чтоб не появлялось ошибок от логера, можно настроить путь до файлов логгирования, в файле ```log4j2.yml``` проперти ```value: /home/efim/payment-log```
ну если не зделать, то ничего срашного не случится.

Дак как-же запускать? Если просто, то нужно найти класс ```Application.java``` в этом классе один метод и Intellij IDEA
нарисует зеленый треугольник напротив его и т.е. нужно нажать на него и сервис запустится.


Далее, после того как бот в телеграмме запущен и Сервис обработки email тоже работает, нужно сделать несколько вещей:
в ```email:destination: "mail@mail.ru|mail1@mail.ru"``` в application.yml уже есть два email'а и в принципе можно и пользоватся этим скписком.
В боте в телеграмм отправляем команду ```/register mail@mail.ru``` тем самым регистрируемся на слушанье  сообщений, отправленных на этот email.
Далее нам нужно отправить объект вида 
```
{
	"subject": "Email subject",
	"text": "Email body"
}
```

по такому УРЛу ```http://localhost:9097/api/notifier/send``` методом POST, можно для этих целей
использовать ```Postman``` или ```curl```. Если вы подписанны на рассылку, то в телеграмм, в том чате где регистрировали email придет сообщение.


В принципе все, больше рассказывать не очем. В связи с тем, что давалось совсем немного времени и задача эта тестовая, не писал unit тесты и javadoc.
